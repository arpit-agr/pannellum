{%- extends "layouts/base.html" -%}

{% set fallbackUrl = "/images/" + image.fallback %}
{% set imgPath = "/images/" + page.fileSlug %}

{%- block preload -%}
  <link rel="preload" href="/scripts/index.js" as="script" fetchpriority="high">
{%- endblock -%}

{%- block content -%}
  <div id="panorama" data-desc="{{ image.description }}">
    <noscript>
      <img src={{ fallbackUrl }} alt="{{ image.description }}">
    </noscript>
  </div>
  <div class="image-info cluster">
    <div class="stack">
      {{ content | safe }}
      <a class="link" href="/">
        <span>‚Üê Home</span>
        {%- include "snippets/underline.html" -%}
      </a>
    </div>
    <p>
      {{ image.subtitle }}
      <br>
      Photo credit:
      <a href="{{ image.credit.link }}">
        {{ image.credit.name | addNbsp | safe }}
      </a>
    </p>
  </div>
{%- endblock -%}

{%- block bodyScripts -%}
<script src="/scripts/index.js"></script>

  <script>
    pannellum.viewer('panorama', {
    "type": "multires",
    "multiRes": {
        "basePath": "{{ imgPath }}",
        "path": "/%l/%s%y_%x",
        "extension": "jpg",
        "tileResolution": 512,
        "maxLevel": {{ image.maxLevel }},
        "cubeResolution": {{ image.cubeResolution }}
      },
      "autoLoad": true,
      "yaw": {{ image.yaw }},
      "pitch": {{ image.pitch}},
      "hfov": {{ image.fov }},
      "keyboardZoom": false,
      "mouseZoom": false
    });
  </script>
{%- endblock -%}